# ğŸ¦ Dá»± Ãn NgÃ¢n HÃ ng Sá»‘ â€“ Core Banking MVP

## ğŸŒŸ Má»¥c tiÃªu

Dá»±ng há»‡ thá»‘ng **Core Banking MVP** gá»“m:

- ÄÄƒng kÃ½ / Ä‘Äƒng nháº­p ngÆ°á»i dÃ¹ng
- LÆ°u trá»¯ há»“ sÆ¡ ngÆ°á»i dÃ¹ng
- Giao dá»‹ch chuyá»ƒn tiá»n
- PhÃ¡t hiá»‡n rá»§i ro & gian láº­n theo thá»i gian thá»±c
- Gáº¯n káº¿t Kafka, Cassandra, PostgreSQL, Docker, CI/CD

## ğŸ“¦ CÃ¡c thÃ nh pháº§n Ä‘Ã£ triá»ƒn khai

### 1. Auth Service (`auth-service`)

- Go HTTP server
- Endpoints: `/register`, `/login`, `/refresh-token`
- Sá»­ dá»¥ng JWT
- âœ… ÄÃ£ cháº¡y á»•n

---

### 2. User Profile Service (`user-profile-service`)

- CRUD há»“ sÆ¡ ngÆ°á»i dÃ¹ng
- Middleware xÃ¡c thá»±c JWT
- Káº¿t ná»‘i PostgreSQL
- âœ… ÄÃ£ cháº¡y á»•n Ä‘á»‹nh

---

### 3. Transaction Ledger (`transaction-ledger`)

- HTTP server Go vá»›i endpoint `/transaction`
- Táº¡o transaction ID vÃ  timestamp UTC
- Kafka producer gá»­i JSON Ä‘áº¿n topic `transactions`
- Kafka dÃ¹ng thÆ° viá»‡n `segmentio/kafka-go`
- Cassandra lÃ m backend báº¥t biáº¿n (Ä‘ang tÃ­ch há»£p)
- âœ… ÄÃ£ test thÃ nh cÃ´ng qua Postman (tráº£ vá» `transaction_id`)

---

### 4. Risk Detection Service (`risk-detection`)

- Cáº¥u trÃºc Go chuáº©n: `cmd`, `internal`, `Makefile`

- API `/health`

- Kafka consumer tá»« topic `transactions`

- Module `EvaluateRisk()` gá»“m cÃ¡c rule:

  - > 5 giao dá»‹ch trong 1 giá» â†’ `HIGH_RISK`
  - > 500 triá»‡u VNÄ â†’ `HIGH_RISK`
  - NgÆ°á»£c láº¡i â†’ `LOW_RISK`

- Ghi log chi tiáº¿t (user_id, amount, risk_level, timestamp)

- âœ… ÄÃ£ cháº¡y thÃ nh cÃ´ng vÃ  xá»­ lÃ½ real-time

---

### 5. Kafka + Zookeeper

- DÃ¹ng Bitnami Docker images
- ÄÃ£ chá»‰nh `ADVERTISED_LISTENERS=127.0.0.1:9092`
- Kafka broker káº¿t ná»‘i OK vá»›i cÃ¡c service Go
- âœ… á»”n Ä‘á»‹nh

---

### 6. Docker Infrastructure

- Docker Compose quáº£n lÃ½ PostgreSQL, Cassandra, Kafka, Zookeeper, Keycloak
- Táº¥t cáº£ cháº¡y Ä‘Æ°á»£c báº±ng `docker compose up -d`
- âœ… Háº¡ táº§ng hoáº¡t Ä‘á»™ng tá»‘t

---

### 7. Postman Test Suite

- ÄÃ£ táº¡o collection test cÃ¡c API: `/register`, `/login`, `/transaction`
- âœ… Test thÃ nh cÃ´ng, nháº­n token, gá»­i giao dá»‹ch

---

## ğŸ—‚ Cáº¥u trÃºc thÆ° má»¥c

```bash
â”‚   docker-compose.yml
â”‚   Makefile
â”‚   README.md
â”‚
â”œâ”€â”€ auth-service
â”‚   â””â”€â”€ main.go
â”‚
â”œâ”€â”€ user-profile-service
â”‚   â””â”€â”€ main.go
â”‚
â”œâ”€â”€ transaction-ledger
â”‚   â”œâ”€â”€ go.mod, go.sum, Makefile
â”‚   â”œâ”€â”€ cmd/server/main.go
â”‚   â””â”€â”€ internal
â”‚       â”œâ”€â”€ handler/transaction.go
â”‚       â””â”€â”€ kafka/producer.go
â”‚
â””â”€â”€ risk-detection
    â”œâ”€â”€ go.mod, go.sum, Makefile
    â”œâ”€â”€ cmd/server/main.go
    â””â”€â”€ internal
        â”œâ”€â”€ app/risk_engine.go
        â”œâ”€â”€ handler/http.go
        â”œâ”€â”€ kafka/consumer.go
        â””â”€â”€ risk/risk.go
```

---

## ğŸ”„ Tiáº¿n trÃ¬nh tá»•ng quÃ¡t (Ä‘Ã£ hoÃ n thÃ nh)

| BÆ°á»›c                                | Tráº¡ng thÃ¡i |
| ----------------------------------- | ---------- |
| Thiáº¿t káº¿ kiáº¿n trÃºc dá»‹ch vá»¥          | âœ… Done    |
| Setup Docker Infra                  | âœ… Done    |
| Táº¡o 3 service Go cÆ¡ báº£n             | âœ… Done    |
| Test API qua Postman                | âœ… Done    |
| Táº¡o `risk-detection` chuáº©n          | âœ… Done    |
| Gáº¯n Kafka consumer cho risk service | âœ… Done    |
| Fix lá»—i `connect`, `no host` Kafka  | âœ… Done    |
| Kafka á»•n Ä‘á»‹nh, sáºµn sÃ ng hoáº¡t Ä‘á»™ng   | âœ… Done    |

---

## âš¡ï¸ Giai Ä‘oáº¡n tiáº¿p theo (Ä‘ang triá»ƒn khai)

| BÆ°á»›c                                      | Tráº¡ng thÃ¡i  | Ghi chÃº                         |
| ----------------------------------------- | ----------- | ------------------------------- |
| Gáº¯n Kafka Producer cho transaction-ledger | ğŸŸ¡ Äang lÃ m | Gá»­i giao dá»‹ch qua Kafka         |
| Gá»­i giao dá»‹ch Ä‘áº¿n topic `transactions`    | ğŸŸ¡ Äang lÃ m | risk-detection sáº½ tiáº¿p nháº­n     |
| Ghi log/pháº£n há»“i HIGH_RISK tá»« risk-engine | ğŸŸ¡ ChÆ°a     | ÄÃ£ cÃ³ logic, cáº§n output rÃµ rÃ ng |
| (TÃ¹y chá»n) Gá»­i alert hoáº·c lÆ°u risk        | ğŸ–’ Káº¿ tiáº¿p   | Má»Ÿ rá»™ng logic náº¿u cáº§n           |

---

## ğŸ”­ Lá»™ trÃ¬nh tiáº¿p theo

1. âœ«ï¸ HoÃ n thiá»‡n Kafka producer trong `transaction-ledger`
2. ğŸš€ Gá»­i giao dá»‹ch máº«u tá»« API `/transaction`
3. âœ… Tháº¥y log cáº£nh bÃ¡o tá»« `risk-detection`
4. ğŸ§© Gáº¯n loyalty / cashback (Grok + Claude)
5. âš™ï¸ HoÃ n thiá»‡n CI / Makefile / Test automation
